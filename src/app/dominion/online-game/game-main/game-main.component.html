<ng-container *ngIf="{
      isMyTurn:     isMyTurn$     | async,
      chatOpened:   chatOpened$   | async,
      gameSnapshot: gameSnapshot$ | async,
      myIndex:      myIndex$      | async,
      message:      message$      | async
    } as data">
  <div class="body">
    <div class="sidebar">
      <button mat-button (click)="toggleSideNav( sidenav )"
          matTooltip="show/hide messages" matTooltipPosition="after">
        <mat-icon>textsms</mat-icon>
      </button>
      <mat-button-toggle-group [vertical]="true" (change)="toggleAutoScroll( $event.value )">
        <mat-button-toggle [value]="false" [checked]="!autoScroll"
              matTooltip="auto scroll off" matTooltipPosition="after">
          <mat-icon>pause</mat-icon>
        </mat-button-toggle>
        <mat-button-toggle [value]="true"  [checked]="autoScroll"
              matTooltip="auto scroll on" matTooltipPosition="after">
          <mat-icon>play_arrow</mat-icon>
        </mat-button-toggle>
      </mat-button-toggle-group>

      <span class="spacer"></span>

      <ng-container>



        <ng-container *ngIf="data.isMyTurn">
          <button mat-button (click)="goToNextPhase( data.gameSnapshot )"
              matTooltip="Go to next phase" matTooltipPosition="after">
            <mat-icon class="goToNextPhaseIcon">file_download</mat-icon>
          </button>
          <button mat-button (click)="goToNextPlayer()"
              matTooltip="Finish my turn" matTooltipPosition="after">
            <mat-icon>forward</mat-icon>
          </button>
        </ng-container>

        <app-turn-info></app-turn-info>

        <button mat-button (click)="sortMyHandCards( data.gameSnapshot, data.myIndex )"
            matTooltip="Sort hand cards" matTooltipPosition="after">
          <mat-icon>sort</mat-icon>
        </button>

        <button mat-button (click)="incrementTurnCounter()">++</button>
        <button mat-button (click)="logSnapshot()">log</button>
        <!-- <button mat-button (click)="faceUpCards()">表</button>
        <button mat-button (click)="faceDownCards()">裏</button> -->

      </ng-container>
    </div>

    <mat-sidenav-container class="sidenavContainer">
      <mat-sidenav #sidenav class="sidenav" mode="side" disableClose="true"
            [opened]="data.chatOpened" >
        <app-chat [autoScroll]="autoScroll" [sidenav]="sidenav"> </app-chat>
      </mat-sidenav>

      <div class="column">
        <div class="upper-part">
          <div class="shared-area_other-player-area">
            <app-shared-area class="shared-area"
              (cardClicked)="onCardClicked( $event )">
            </app-shared-area>
            <app-other-player-area
              (cardClicked)="onCardClicked( $event )">
            </app-other-player-area>
          </div>
          <div *ngIf="!data.isMyTurn">
            <app-turn-player-area
              (cardClicked)="onCardClicked( $event )">
            </app-turn-player-area>
          </div>
        </div>
        <div class="spacer"></div>
        <div class="message-area-wrapper">
          <div class="message-area">
            {{data.message}}
          </div>
        </div>
        <div class="my-area-wrapper">
          <app-my-area
            (cardClicked)="onCardClicked( $event )">
          </app-my-area>
        </div>
      </div>

    </mat-sidenav-container>
  </div>
</ng-container>
